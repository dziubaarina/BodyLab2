{% extends "base.html" %}

{% block title %}Panel Menedżera{% endblock %}

{% block content %}
<style>
    .table-responsive {
        max-height: 600px;
    }
    .role-badge {
        font-size: 0.9rem;
        padding: 0.4em 0.7em;
    }
    .form-select-sm {
        width: 120px;
    }
</style>

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h2">Panel Menedżera</h1>
</div>

<h3 class="h5 mb-3" style="color: #d8b0b0;">Zarządzaj Użytkownikami</h3>
<p class="text-muted">Poniżej znajduje się lista wszystkich użytkowników w systemie. Możesz zmieniać ich role.</p>

<div class="table-responsive">
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Nazwa Użytkownika</th>
                <th scope="col">Email</th>
                <th scope="col">Rola</th>
                <th scope="col">Akcja</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <th scope="row">{{ user.id }}</th>
                <td>{{ user.username }}</td>
                <td>{{ user.email }}</td>
                <td>
                    <span class="badge rounded-pill
                        {% if user.is_admin %} bg-danger role-badge
                        {% elif user.is_trainer %} bg-info text-dark role-badge
                        {% else %} bg-secondary role-badge {% endif %}">
                        {{ user.role | capitalize }}
                    </span>
                </td>
                <td>
                    {% if user.id != current_user.id %}
                    <form action="{{ url_for('admin_edit_user', user_id=user.id) }}" method="POST" class="d-flex gap-2">
                        <select name="role" class="form-select form-select-sm">
                            <option value="user" {% if user.role == 'user' %}selected{% endif %}>User</option>
                            <option value="trainer" {% if user.role == 'trainer' %}selected{% endif %}>Trainer</option>
                            <option value="admin" {% if user.role == 'admin' %}selected{% endif %}>Admin</option>
                        </select>
                        <button type="submit" class="btn btn-primary btn-sm">Zapisz</button>
                    </form>
                    {% else %}
                    <span class="text-muted fst-italic">To Ty</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}