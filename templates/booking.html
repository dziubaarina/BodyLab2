{% extends "base.html" %}

{% block title %}Rezerwuj Zajęcia{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="display-4">Rezerwuj Zajęcia</h1>
            <p class="lead">Wybierz zajęcia dla siebie. Dziś jest {{ today.strftime('%d.%m.%Y') }}.</p>
        </div>
    </div>
    <hr>

    <!-- Pasek zakładek (Tabs) -->
    <ul class="nav nav-pills nav-fill mb-4" id="bookingTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="grupowe-tab" data-bs-toggle="tab" data-bs-target="#grupowe" type="button" role="tab" aria-controls="grupowe" aria-selected="true">
                Treningi Grupowe
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="indywidualne-tab" data-bs-toggle="tab" data-bs-target="#indywidualne" type="button" role="tab" aria-controls="indywidualne" aria-selected="false">
                Treningi Indywidualne
            </button>
        </li>
    </ul>

    <!-- Zawartość Zakładek -->
    <div class="tab-content" id="bookingTabsContent">

        <!-- === Zakładka Treningi Grupowe === -->
        <div class="tab-pane fade show active" id="grupowe" role="tabpanel" aria-labelledby="grupowe-tab">
            {% if not items_grupowe %}
                <div class="alert alert-info">Brak nadchodzących zajęć grupowych.</div>
            {% else %}
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                    {% for item in items_grupowe %}
                        {% include '_session_card.html' %}
                    {% endfor %}
                </div>
            {% endif %}
        </div>

        <!-- === Zakładka Treningi Indywidualne === -->
        <div class="tab-pane fade" id="indywidualne" role="tabpanel" aria-labelledby="indywidualne-tab">
            {% if not items_indywidualne %}
                <div class="alert alert-info">Brak nadchodzących zajęć indywidualnych.</div>
            {% else %}
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                    {% for item in items_indywidualne %}
                        {% include '_session_card.html' %}
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var triggerTabList = [].slice.call(document.querySelectorAll('#bookingTabs button'))
        triggerTabList.forEach(function (triggerEl) {
            // Check if bootstrap is defined
            if (typeof bootstrap !== 'undefined') {
                 var tabTrigger = new bootstrap.Tab(triggerEl)
                 triggerEl.addEventListener('click', function (event) {
                    event.preventDefault()
                    tabTrigger.show()
                })
            } else {
                // Fallback or retry logic if bootstrap isn't loaded yet
                 console.warn('Bootstrap is not defined yet. Tabs might not work properly.');
                 // Simple fallback using attributes
                 triggerEl.addEventListener('click', function (event) {
                    event.preventDefault();
                    // Remove active class from all buttons and hide all panes
                     triggerTabList.forEach(btn => {
                        btn.classList.remove('active');
                        const targetId = btn.getAttribute('data-bs-target');
                        const pane = document.querySelector(targetId);
                        if(pane) {
                           pane.classList.remove('show', 'active');
                        }
                     });
                    // Add active class to clicked button and show target pane
                    this.classList.add('active');
                    const targetId = this.getAttribute('data-bs-target');
                    const pane = document.querySelector(targetId);
                    if(pane) {
                        pane.classList.add('show', 'active');
                    }
                })
            }


        })
    });
</script>
{% endblock %}